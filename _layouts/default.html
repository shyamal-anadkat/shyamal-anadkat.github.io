<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="color-scheme" content="light dark">
    <link rel="sitemap" type="application/xml" title="Sitemap" href="{{ "/sitemap.xml" | relative_url }}" />

    <title>{{ page.title | default: site.title }}</title>
    <meta name="description" content="{{ page.excerpt | strip_html | default: site.description }}">
    <meta name="robots" content="index, follow">

    {% seo %}
    <link rel="stylesheet" href="{{ "/assets/css/style.css?v=" | append: site.github.build_revision | relative_url }}">
    <link rel="stylesheet" href="{{ "/assets/css/theme.css" | relative_url }}">
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    {% include head-custom.html %}
  </head>
  <body>
<div class="grid-background"></div>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Only create particles if in dark mode
    function createParticles() {
      if (document.body.classList.contains('dark-mode')) {
        for (let i = 0; i < 10; i++) {
          setTimeout(function() {
            const particle = document.createElement('div');
            particle.classList.add('particle');
            particle.style.left = Math.random() * 100 + '%';
            particle.style.top = (Math.random() * 50 + 50) + '%'; // Start particles from bottom half
            particle.style.opacity = Math.random() * 0.6 + 0.2;
            
            // Varied particle sizes
            const size = Math.random() * 2 + 1;
            particle.style.width = size + 'px';
            particle.style.height = size + 'px';
            
            // Add subtle blur for glow effect
            particle.style.boxShadow = `0 0 ${size * 2}px rgba(100, 214, 255, 0.6)`;
            
            document.body.appendChild(particle);
            
            // Remove particles after animation completes
            setTimeout(function() {
              if (particle && particle.parentNode) {
                particle.remove();
              }
            }, 15000);
          }, i * 800); // Slightly faster creation
        }
      }
    }
    
    // Fix layout issues
    function fixLayoutIssues() {
      if (document.body.classList.contains('dark-mode')) {
        // Fix any toggle switch positioning
        const toggleSwitch = document.querySelector('.theme-toggle');
        if (toggleSwitch) {
          toggleSwitch.style.display = 'inline-block';
          toggleSwitch.style.marginBottom = '20px';
        }
        
        // Improve spacing for description paragraphs
        const description = document.querySelector('header p');
        if (description) {
          description.style.lineHeight = '1.6';
          description.style.margin = '20px 0';
        }
      }
    }
    
    // Create initial particles if in dark mode
    createParticles();
    fixLayoutIssues();
    
    // Add observer for theme changes
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.attributeName === 'class') {
          if (mutation.target.classList.contains('dark-mode')) {
            createParticles();
            fixLayoutIssues();
          }
        }
      });
    });
    
    observer.observe(document.body, { attributes: true });
    
    // Create new particles periodically but only if visible tab
    let particleInterval = setInterval(createParticles, 10000);
    
    // Pause animation when tab is not visible to save resources
    document.addEventListener('visibilitychange', function() {
      if (document.hidden) {
        clearInterval(particleInterval);
      } else {
        particleInterval = setInterval(createParticles, 10000);
      }
    });
    
    // Handle window resize for better responsiveness
    window.addEventListener('resize', fixLayoutIssues);
  });
</script>
    <div class="wrapper">
      <header>
        <h1><a href="{{ "/" | absolute_url }}">{{ site.title | default: site.github.repository_name }}</a></h1>

        {% if site.logo %}
          <img src="{{site.logo | relative_url}}" alt="Logo" />
        {% endif %}

        <br/><br/><hr><p>{{ site.description | default: site.github.project_tagline }}</p>

        <div class="theme-toggle" style="margin-top:1rem;">
          <input type="checkbox" id="theme-toggle" class="toggle-checkbox" />
          <label for="theme-toggle" class="toggle-label">
            <span class="icon sun-icon">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                <circle cx="12" cy="12" r="5"/>
              </svg>
            </span>
            <span class="icon moon-icon">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                <path d="M21.75 15.5A9 9 0 0 1 8.5 2.25a9 9 0 1 0 13.25 13.25z"/>
              </svg>
            </span>
          </label>
        </div>

<!--         {% if site.github.is_user_page %}
        <p class="view"><a href="{{ site.github.owner_url }}">View My GitHub Profile</a></p>
        {% endif %} -->
      </header>
      <section>

      {{ content }}

      </section>
      <footer>
        {% if site.github.is_project_page %}
        <p>This space is maintained by <a href="{{ site.github.owner_url }}">{{ site.github.owner_name }}</a></p>
        {% endif %}
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="https://unpkg.com/@lyket/widget@latest/dist/lyket.js?apiKey=pt_e8b43a7181ccee823728489fc4a8c7"></script>
    <script src="{{ "/assets/js/scale.fix.js" | relative_url }}"></script>
    <script>
      (function() {
        var toggleCheckbox = document.getElementById('theme-toggle');
        var saved = localStorage.getItem('theme');
        function updateToggle() {
          toggleCheckbox.checked = document.body.classList.contains('dark-mode');
        }
        if (saved === 'dark') {
          document.body.classList.add('dark-mode');
        } else if (saved === 'light') {
          document.body.classList.add('light-mode');
        } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          document.body.classList.add('dark-mode');
        }
        updateToggle();
        toggleCheckbox.addEventListener('change', function() {
          if (toggleCheckbox.checked) {
            document.body.classList.add('dark-mode');
            document.body.classList.remove('light-mode');
            localStorage.setItem('theme', 'dark');
          } else {
            document.body.classList.remove('dark-mode');
            document.body.classList.add('light-mode');
            localStorage.setItem('theme', 'light');
          }
        });
      })();
    </script>
  </body>
</html>
